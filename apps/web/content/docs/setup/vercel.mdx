---
title: Vercel Deployment
description: Deploy the sync app to Vercel
---

import { FAQAccordion, FAQAccordionItem } from "@/components/mdx/faq-accordion";
import { SetupChecklist, SetupChecklistItem } from "@/components/mdx/setup-checklist";
import { Callout } from "fumadocs-ui/components/callout";
import { Steps, Step } from "fumadocs-ui/components/steps";

This guide walks through deploying the sync application to Vercel.

<SetupChecklist title="Quick Reference Checklist">
  <SetupChecklistItem>Deployed app to Vercel</SetupChecklistItem>
  <SetupChecklistItem>Set NEXTAUTH_SECRET environment variable</SetupChecklistItem>
  <SetupChecklistItem>Set Google OAuth credentials</SetupChecklistItem>
  <SetupChecklistItem>Set AUTHORIZED_EMAILS</SetupChecklistItem>
  <SetupChecklistItem>Added Redis storage (Upstash)</SetupChecklistItem>
  <SetupChecklistItem>Updated Google OAuth redirect URI</SetupChecklistItem>
  <SetupChecklistItem>Completed setup wizard</SetupChecklistItem>
</SetupChecklist>

## One-Click Deploy

The easiest way to deploy is using the deploy button:

<a href="https://vercel.com/new/clone?repository-url=https%3A%2F%2Fgithub.com%2Fmcsdevv%2Fwhile-dashboard-template&env=NEXTAUTH_SECRET,GOOGLE_CLIENT_ID,GOOGLE_CLIENT_SECRET,NOTION_API_TOKEN,AUTHORIZED_EMAILS&envDescription=Required%20environment%20variables%20for%20While&envLink=https%3A%2F%2Fwhile.so%2Fdocs%2Fsetup%2Fvercel&project-name=while&repository-name=while" target="_blank" rel="noopener noreferrer">
  <img src="https://vercel.com/button" alt="Deploy with Vercel" />
</a>

## Environment Variables

During deployment, you'll need to configure these environment variables:

### Required Variables

<EnvVarsTable vars={[
  { name: "NEXTAUTH_SECRET", description: "Session encryption key", howToGet: <>Generate with <code>openssl rand -base64 32</code></>, generate: "base64" },
  { name: "GOOGLE_CLIENT_ID", description: "Google OAuth client ID (auth + calendar)", howToGetLink: { href: "/docs/setup/google", label: "Google OAuth Setup" } },
  { name: "GOOGLE_CLIENT_SECRET", description: "Google OAuth client secret", howToGetLink: { href: "/docs/setup/google", label: "Google OAuth Setup" } },
  { name: "NOTION_API_TOKEN", description: "Notion integration token", howToGetLink: { href: "/docs/setup/notion", label: "Notion Setup" } },
  { name: "AUTHORIZED_EMAILS", description: "Comma-separated emails, spaces trimmed", howToGet: <>Your email or pattern (e.g., <code>you@gmail.com, *@company.com</code>)</> },
  { name: "UPSTASH_REDIS_REST_URL", description: "Upstash Redis REST endpoint", howToGetLink: { href: "#add-redis-storage", label: "Add via Vercel Storage" }, hideInput: true },
  { name: "UPSTASH_REDIS_REST_TOKEN", description: "Upstash Redis auth token", howToGetLink: { href: "#add-redis-storage", label: "Add via Vercel Storage" }, hideInput: true },
]} />

<Callout type="info">
Redis storage (`UPSTASH_REDIS_REST_URL` and `UPSTASH_REDIS_REST_TOKEN`) is automatically configured when you add the Upstash integration from the Vercel Marketplace.
</Callout>

### Optional Variables

<EnvVarsTable vars={[
  { name: "NEXTAUTH_URL", description: "App URL (auto-detected on Vercel)", default: "Auto", hideInput: true },
  { name: "SETTINGS_ENCRYPTION_KEY", description: "Credential encryption key", generate: "base64", default: "None" },
  { name: "LOG_LEVEL", description: "Logging verbosity", default: "info" },
]} />

## Generate Secrets

`NEXTAUTH_SECRET` is required. `SETTINGS_ENCRYPTION_KEY` is recommended for production.

### Using OpenSSL (macOS/Linux)

```bash
openssl rand -base64 32
```

### Using Node.js

```bash
node -e "console.log(require('crypto').randomBytes(32).toString('base64'))"
```

<Callout type="info">
If using `SETTINGS_ENCRYPTION_KEY`, generate a separate value from `NEXTAUTH_SECRET`.
</Callout>

## Add Redis Storage

During or after deployment, add Redis storage via the Vercel Marketplace:

1. Go to your Vercel project dashboard
2. Click **Storage** in the sidebar
3. Click **Connect Store** and select **Upstash Redis**
4. Follow the prompts to create a new Redis database
5. The environment variables (`UPSTASH_REDIS_REST_URL` and `UPSTASH_REDIS_REST_TOKEN`) are automatically added to your project

<Callout type="info">
The Vercel Marketplace integration handles all configuration automatically. No separate Upstash account is needed.
</Callout>

## Post-Deployment Steps

### 1. Update Google OAuth Redirect URI

After deployment, update your Google OAuth credentials with your actual Vercel domain:

```
https://your-app-name.vercel.app/api/auth/callback/google
```

### 2. Complete Setup Wizard

1. Open your deployed app URL
2. Follow the setup wizard to connect Google and Notion
3. Configure field mappings
4. Test the connection

### 3. Enable Cron Jobs (Optional)

Vercel automatically runs cron jobs defined in `vercel.json`:
- **Notion sync**: Daily at 3am UTC
- **Webhook renewal**: Daily at noon UTC

<Callout type="info" title="Note">
Free Vercel accounts have cron job limitations. Check [Vercel pricing](https://vercel.com/pricing) for details.
</Callout>

## Custom Domain (Optional)

To use a custom domain:

1. Go to your Vercel project settings
2. Click **Domains**
3. Add your domain
4. Update DNS records as instructed
5. Update Google OAuth redirect URIs to use your custom domain

## Troubleshooting

<FAQAccordion>
  <FAQAccordionItem title="Build Fails">
    - Check environment variables are set correctly
    - Verify all required variables are present
    - Check build logs for specific errors
  </FAQAccordionItem>
  <FAQAccordionItem title="OAuth Errors After Deploy">
    - Update Google OAuth redirect URIs with your Vercel domain
    - Ensure URIs match exactly (including https://)
    - Clear browser cookies and try again
  </FAQAccordionItem>
  <FAQAccordionItem title="Redis Connection Failed">
    - Verify Redis is connected via Vercel Storage tab
    - Check environment variables are set in project settings
    - Try disconnecting and reconnecting the Upstash integration
  </FAQAccordionItem>
</FAQAccordion>

## Updating the App

To update to the latest version:

1. Go to your GitHub repository (created during deploy)
2. Sync with the upstream repository
3. Vercel will automatically redeploy

Or manually trigger a redeploy from the Vercel dashboard.
