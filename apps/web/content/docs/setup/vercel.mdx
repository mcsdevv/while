---
title: Vercel Deployment
description: Deploy the sync app to Vercel
---

import { FAQAccordion, FAQAccordionItem } from "@/components/mdx/faq-accordion";
import { SetupChecklist, SetupChecklistItem } from "@/components/mdx/setup-checklist";
import { Callout } from "fumadocs-ui/components/callout";
import { Steps, Step } from "fumadocs-ui/components/steps";

This guide walks through deploying the sync application to Vercel.

<SetupChecklist title="Quick Reference Checklist">
  <SetupChecklistItem>Deployed app to Vercel</SetupChecklistItem>
  <SetupChecklistItem>Set NEXTAUTH_SECRET environment variable</SetupChecklistItem>
  <SetupChecklistItem>Set Google OAuth credentials</SetupChecklistItem>
  <SetupChecklistItem>Set AUTHORIZED_EMAILS</SetupChecklistItem>
  <SetupChecklistItem>Added Redis storage (Upstash)</SetupChecklistItem>
  <SetupChecklistItem>Updated Google OAuth redirect URI</SetupChecklistItem>
  <SetupChecklistItem>Completed setup wizard</SetupChecklistItem>
</SetupChecklist>

## One-Click Deploy

The easiest way to deploy is using the deploy button:

<a href="https://vercel.com/new/clone?repository-url=https%3A%2F%2Fgithub.com%2Fmcsdevv%2Fwhile%2Ftree%2Fmain%2Fapps%2Fdashboard">
  <img src="https://vercel.com/button" alt="Deploy with Vercel" />
</a>

## Environment Variables

During deployment, you'll need to configure these environment variables:

### Required Variables

| Variable | Description | How to Get |
|----------|-------------|------------|
| `NEXTAUTH_SECRET` | Session encryption key | Generate with `openssl rand -base64 32` |
| `GOOGLE_CLIENT_ID` | Google OAuth client ID (auth + calendar) | [Google OAuth Setup](/docs/setup/google) |
| `GOOGLE_CLIENT_SECRET` | Google OAuth client secret | [Google OAuth Setup](/docs/setup/google) |
| `AUTHORIZED_EMAILS` | Emails allowed to sign in | Your email or pattern (e.g., `*@company.com`) |
| `UPSTASH_REDIS_REST_URL` | Upstash Redis REST endpoint | [Add via Vercel Storage](#add-redis-storage) |
| `UPSTASH_REDIS_REST_TOKEN` | Upstash Redis auth token | [Add via Vercel Storage](#add-redis-storage) |

<Callout type="info">
Redis storage (`UPSTASH_REDIS_REST_URL` and `UPSTASH_REDIS_REST_TOKEN`) is automatically configured when you add the Upstash integration from the Vercel Marketplace.
</Callout>

### Optional Variables

| Variable | Description | Default |
|----------|-------------|---------|
| `NEXTAUTH_URL` | App URL (auto-detected on Vercel) | Auto |
| `SETTINGS_ENCRYPTION_KEY` | Credential encryption key | None (recommended for production) |
| `AUTHORIZED_DOMAINS` | Domain allowlist (e.g., `company.com`) | None |
| `SETUP_TOKEN` | One-time setup access token | None |
| `LOG_LEVEL` | Logging verbosity | `info` |

## Generate Secrets

`NEXTAUTH_SECRET` is required. `SETTINGS_ENCRYPTION_KEY` is recommended for production.

### Using OpenSSL (macOS/Linux)

```bash
openssl rand -base64 32
```

### Using Node.js

```bash
node -e "console.log(require('crypto').randomBytes(32).toString('base64'))"
```

<Callout type="info">
If using `SETTINGS_ENCRYPTION_KEY`, generate a separate value from `NEXTAUTH_SECRET`.
</Callout>

## Add Redis Storage

During or after deployment, add Redis storage via the Vercel Marketplace:

1. Go to your Vercel project dashboard
2. Click **Storage** in the sidebar
3. Click **Connect Store** and select **Upstash Redis**
4. Follow the prompts to create a new Redis database
5. The environment variables (`UPSTASH_REDIS_REST_URL` and `UPSTASH_REDIS_REST_TOKEN`) are automatically added to your project

<Callout type="info">
The Vercel Marketplace integration handles all configuration automatically. No separate Upstash account is needed.
</Callout>

## Post-Deployment Steps

### 1. Update Google OAuth Redirect URI

After deployment, update your Google OAuth credentials with your actual Vercel domain:

```
https://your-app-name.vercel.app/api/auth/callback/google
```

### 2. Complete Setup Wizard

1. Open your deployed app URL
2. Follow the setup wizard to connect Google and Notion
3. Configure field mappings
4. Test the connection

### 3. Enable Cron Jobs (Optional)

Vercel automatically runs cron jobs defined in `vercel.json`:
- **Notion sync**: Daily at 3am UTC
- **Webhook renewal**: Daily at noon UTC

<Callout type="info" title="Note">
Free Vercel accounts have cron job limitations. Check [Vercel pricing](https://vercel.com/pricing) for details.
</Callout>

## Custom Domain (Optional)

To use a custom domain:

1. Go to your Vercel project settings
2. Click **Domains**
3. Add your domain
4. Update DNS records as instructed
5. Update Google OAuth redirect URIs to use your custom domain

## Troubleshooting

<FAQAccordion>
  <FAQAccordionItem title="Build Fails">
    - Check environment variables are set correctly
    - Verify all required variables are present
    - Check build logs for specific errors
  </FAQAccordionItem>
  <FAQAccordionItem title="OAuth Errors After Deploy">
    - Update Google OAuth redirect URIs with your Vercel domain
    - Ensure URIs match exactly (including https://)
    - Clear browser cookies and try again
  </FAQAccordionItem>
  <FAQAccordionItem title="Redis Connection Failed">
    - Verify Redis is connected via Vercel Storage tab
    - Check environment variables are set in project settings
    - Try disconnecting and reconnecting the Upstash integration
  </FAQAccordionItem>
</FAQAccordion>

## Updating the App

To update to the latest version:

1. Go to your GitHub repository (created during deploy)
2. Sync with the upstream repository
3. Vercel will automatically redeploy

Or manually trigger a redeploy from the Vercel dashboard.
